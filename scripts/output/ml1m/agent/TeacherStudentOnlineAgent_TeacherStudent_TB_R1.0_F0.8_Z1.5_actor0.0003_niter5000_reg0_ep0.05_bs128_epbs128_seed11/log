Loading environment
Load immediate user response model
Load (checkpoint) from output/ml1m/env/user_KRMBUserResponse_MaxOut_lr0.0001_reg0.1.model.checkpoint
{'raw_data_size': 995154, 'data_size': [930014, 28060, 28060], 'n_user': 6022, 'n_item': 3043, 'max_seq_len': 50, 'user_features': ['gender', 'age'], 'user_feature_dims': {'gender': 2, 'age': 7}, 'item_features': ['genres'], 'item_feature_dims': {'genres': 18}, 'feedback_type': ['is_click', 'is_like', 'is_star'], 'feedback_size': 3, 'feedback_negative_sample_rate': {'is_click': 5.136864824864332, 'is_like': 1.3583748453666884, 'is_star': 0.2931366510474735}}
Load user sequence reader
initiate MovieLens sequence reader
Loading data files
Load item meta data
Load user meta data
build vocab for onehot features
build vocab for multihot features:
	genres
sequence holdout for users (-1, 0, 0)
{'raw_data_size': 995154, 'data_size': [995154, 0, 0], 'n_user': 6022, 'n_item': 3043, 'max_seq_len': 50, 'user_features': ['gender', 'age'], 'user_feature_dims': {'gender': 2, 'age': 7}, 'item_features': ['genres'], 'item_feature_dims': {'genres': 18}, 'feedback_type': ['is_click', 'is_like', 'is_star'], 'feedback_size': 3, 'feedback_negative_sample_rate': {'is_click': 5.136864824864332, 'is_like': 1.3583748453666884, 'is_star': 0.2931366510474735}}
Setup candiate item pool
Setup policy:
TeacherStudent_TB(
  (userEncoder): BackboneUserEncoder(
    (uIDEmb): Embedding(6023, 16)
    (UFEmb_gender): Linear(in_features=2, out_features=16, bias=True)
    (UFEmb_age): Linear(in_features=7, out_features=16, bias=True)
    (iIDEmb): Embedding(3044, 16)
    (IFEmb_genres): Linear(in_features=18, out_features=16, bias=True)
    (feedbackEncoder): Linear(in_features=3, out_features=32, bias=True)
    (itemEmbNorm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
    (userEmbNorm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)
    (itemFeatureKernel): Linear(in_features=16, out_features=32, bias=True)
    (userFeatureKernel): Linear(in_features=16, out_features=32, bias=True)
    (encDropout): Dropout(p=0.1, inplace=False)
    (encNorm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    (posEmb): Embedding(50, 32)
    (transformer): TransformerEncoder(
      (layers): ModuleList(
        (0-1): 2 x TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=64, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=64, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (stateNorm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
    (finalStateLayer): DNN(
      (layers): Sequential(
        (0): Linear(in_features=96, out_features=128, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.1, inplace=False)
        (3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (4): Linear(in_features=128, out_features=32, bias=True)
      )
    )
    (sigmoid): Sigmoid()
  )
  (bce_loss): BCEWithLogitsLoss()
  (pForwardEncoder): DNN(
    (layers): Sequential(
      (0): Linear(in_features=224, out_features=128, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.1, inplace=False)
      (3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (4): Linear(in_features=128, out_features=32, bias=True)
    )
  )
  (pForwardNorm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
  (logFlowZero): DNN(
    (layers): Sequential(
      (0): Linear(in_features=32, out_features=128, bias=True)
      (1): ReLU()
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (3): Linear(in_features=128, out_features=1, bias=True)
    )
  )
  (teacher_pForwardEncoder): DNN(
    (layers): Sequential(
      (0): Linear(in_features=224, out_features=128, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.1, inplace=False)
      (3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (4): Linear(in_features=128, out_features=32, bias=True)
    )
  )
  (teacher_pForwardNorm): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
  (teacher_logFlowZero): DNN(
    (layers): Sequential(
      (0): Linear(in_features=32, out_features=128, bias=True)
      (1): ReLU()
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (3): Linear(in_features=128, out_features=1, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
<model.buffer.SequentialBuffer.SequentialBuffer object at 0x7f5f8af87c10>
Setup agent
<model.agent.TeacherStudentOnlineAgent.TeacherStudentOnlineAgent object at 0x7f5f8af87b50>
Namespace(actor_decay=0.0, actor_lr=0.0003, actor_lr_teacher=0.0001, batch_size=128, beta_teacher=1.0, buffer_random_rate=0, buffer_size=50000, check_episode=20, cuda=0, device='cpu', dropout_rate=0.1, elbow_greedy=0.1, env_test_holdout=0, env_val_holdout=0, episode_batch_size=128, explore_rate=1.0, final_greedy_epsilon=0.01, gfn_Z=1.5, gfn_Z_teacher=0.0, gfn_flowzero_hidden_dims=[128], gfn_forward_hidden_dims=[128], gfn_forward_offset=0.8, gfn_reward_smooth=1.0, initial_greedy_epsilon=0.05, initial_temper=5, item_correlation=0.2, item_latent_dim=16, l2_coef=0.0, loss='TB', max_step_per_episode=5, model_path='', n_iter=[5000], new_reader_class='', reward_func='get_immediate_reward', save_episode=200, save_path='output/ml1m/agent//TeacherStudentOnlineAgent_TeacherStudent_TB_R1.0_F0.8_Z1.5_actor0.0003_niter5000_reg0_ep0.05_bs128_epbs128_seed11/model', seed=11, single_response=False, slate_size=6, start_train_at_step=10, state_hidden_dims=[128], test_episode=20, train_every_n_step=1, transformer_d_forward=64, transformer_enc_dim=32, transformer_n_head=4, transformer_n_layer=2, uirm_log_path='output/ml1m/env/log/user_KRMBUserResponse_MaxOut_lr0.0001_reg0.1.model.log', user_latent_dim=16)
Run procedures before training
